<!DOCTYPE html>
<html lang="th">

<head>
    <meta name="description" content="Admin Dashboard - Evaluation System">
    <title>Admin Dashboard - Evaluation SPM</title>
    <link rel="icon" type="image/png" href="https://img5.pic.in.th/file/secure-sv1/Untitled-design0bb67699eadca36d.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body class="app sidebar-mini">

    <!-- Navbar-->
    <header class="app-header">
        <a class="app-header__logo" href="admin-dashboard.html">üè´ Evaluation SPM</a>
        <a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
    </header>

    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">

        <div class="app-sidebar__user">
            <div class="box_center">
                <img class="app-sidebar__user-avatar mb-3"
                    src="https://img5.pic.in.th/file/secure-sv1/Untitled-design0bb67699eadca36d.png" id="Pic_Area1">
                <div class="app-sidebar__user-name fw-bold text-white" id="School1">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
                <p class="app-sidebar__user-designation fs-6" id="Area1">Admin</p>
            </div>
        </div>

        <ul class="app-menu">
            <li>
                <a class="app-menu__item" href="#admin-home">
                    <i class="app-menu__icon bi bi-house-heart-fill"></i>
                    <span class="app-menu__label">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#page-user">
                    <i class="app-menu__icon bi bi-person-bounding-box"></i>
                    <span class="app-menu__label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#admin-report">
                    <i class="app-menu__icon bi bi-ui-checks"></i>
                    <span class="app-menu__label">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#qa-report">
                    <i class="app-menu__icon bi bi-clipboard-check"></i>
                    <span class="app-menu__label">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#sexuality-report">
                    <i class="app-menu__icon bi bi-gender-ambiguous"></i>
                    <span class="app-menu__label">‡πÄ‡∏û‡∏®‡∏ß‡∏¥‡∏ñ‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#admin-summary">
                    <i class="app-menu__icon bi bi-bar-chart-fill"></i>
                    <span class="app-menu__label">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="https://line.me/ti/p/H2DIqWXNCp" target="_blank">
                    <i class="app-menu__icon bi bi-line"></i>
                    <span class="app-menu__label">‡∏ô‡∏¥‡πÄ‡∏ó‡∏®@SPM PLK UTT</span>
                </a>
            </li>
            <li>
                <a class="app-menu__item" href="#" id="logoutBT">
                    <i class="app-menu__icon bi bi-x-square-fill"></i>
                    <span class="app-menu__label">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- Content -->
    <main class="app-content">
        <div id="content">
            <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
        </div>
    </main>

    <!-- Footer -->
    <div class="text-center _copyright">
        ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏¥‡πÄ‡∏ó‡∏® ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <br>
        ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏ô‡∏≤‡∏¢‡∏≠‡∏ô‡∏•‡∏±‡∏™ ‡∏Ñ‡∏≤‡∏•‡πÄ‡∏Ñ‡∏• ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏Å‡πå‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£ <br>
        ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å ‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå <br>
        ¬© 2025 All rights reserved.
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script src="js/config.js"></script>
    <script src="js/init-supabase.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/login.js"></script>
    <script src="js/db.js"></script>

    <script>
        window.scriptURL = CONFIG.API_URL;
    </script>

    <script>
        const loadPage = async () => {
            const userID = localStorage.getItem("UserID");
            const userType = localStorage.getItem("UserType");

            // Security check
            if (!userID || userType !== 'admin') {
                alert("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ");
                window.location.href = "index.html";
                return;
            }

            const page = location.hash.slice(1) || 'admin-home';

            try {
                const res = await fetch(`${page}.html`);
                if (!res.ok) throw new Error('Page not found');

                const html = await res.text();
                document.getElementById('content').innerHTML = html;

                // Remove old scripts
                const oldScript = document.getElementById('page-script');
                if (oldScript) oldScript.remove();

                let scriptSrc = '';

                // Load page-specific JS
                if (page === 'page-user') scriptSrc = 'js/edit-user.js';
                else if (page === 'admin-home') scriptSrc = 'js/admin-home.js';
                else if (page === 'admin-report') scriptSrc = 'js/admin-report-s.js';
                else if (page === 'admin-summary') scriptSrc = 'js/admin-summary-s.js';
                else if (page === 'qa-report') scriptSrc = 'js/qa-report.js';
                else if (page === 'sexuality-report') scriptSrc = 'js/sexuality-report.js';

                // Pages that need policy data
                const needsPolicy = ['admin-report', 'admin-summary'].includes(page);

                if (scriptSrc) {
                    if (needsPolicy) {
                        // Load policy data first
                        const policyScript = document.createElement('script');
                        policyScript.src = 'js/admin-form-policy-data.js';
                        policyScript.onload = () => {
                            const mainScript = document.createElement('script');
                            mainScript.id = 'page-script';
                            mainScript.src = scriptSrc + '?v=' + Date.now();
                            document.body.appendChild(mainScript);
                        };
                        document.body.appendChild(policyScript);
                    } else {
                        const script = document.createElement('script');
                        script.id = 'page-script';
                        script.src = scriptSrc + '?v=' + Date.now();
                        document.body.appendChild(script);
                    }
                }
            } catch (err) {
                console.error('Load page error:', err);
                document.getElementById('content').innerHTML = `
          <div class="alert alert-danger">
            <i class="bi bi-exclamation-triangle"></i> ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏î‡πâ: ${err.message}
          </div>
        `;
            }
        };

        window.addEventListener('load', loadPage);
        window.addEventListener('hashchange', loadPage);
    </script>

</body>

</html>